<div class="col-md-3 mb-4">
  <div class="card h-100">
    <% if product.image.attached? %>
      <%= image_tag url_for(product.image), class: "card-img-top", size: "300x200", alt: product.name %>
    <% elsif product.image_filename.present? %>
      <%= image_tag "products/#{product.image_filename}", class: "card-img-top", size: "300x200", alt: product.name %>
    <% else %>
      <%= image_tag "products/placeholder.png", class: "card-img-top", size: "300x200", alt: product.name %>
    <% end %>

    <div class="card-body d-flex flex-column">
      <% if product.stock_quantity > 25 %>
        <span class="badge bg-danger mb-2">On Sale!</span>
      <% end %>
      <% if product.created_at >= 3.days.ago %>
        <span class="badge bg-success mb-2">New</span>
      <% end %>

      <h5 class="card-title"><%= product.name %></h5>
      <p class="card-text mb-1">Price: $<%= product.price %></p>
      <p class="card-text mb-2 text-muted">Category: <%= product.category.name %></p>
      <%= link_to "View Product", product_path(product), class: "btn btn-primary mt-auto" %>
    </div>
  </div>
</div>
